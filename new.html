<!--
Beautiful Single-File Website
Save as: index.html and open in your browser.
Includes: responsive layout, gradient hero, glass cards, simple animations, accessible markup.
Customize colors, fonts, and images as you like.
-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>IIT Operations Dashboard</title>
  <meta name="description" content="Interactive single-file Operations Dashboard for IIT (demo data)">
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9aa7bf; --accent:#4f46e5; --success:#10b981; --danger:#ef4444; --glass: rgba(255,255,255,0.03);
    }
    [data-theme='light']{ --bg:#f6f9fc; --card:#ffffff; --muted:#4b5563; --accent:#4f46e5; --success:#059669; --danger:#dc2626; --glass: rgba(15,23,42,0.04); }

    *{box-sizing:border-box}
    body{margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:var(--bg); color:var(--muted);}
    .app{display:grid;grid-template-columns:260px 1fr;min-height:100vh;gap:20px;padding:20px}

    /* Sidebar */
    .sidebar{background:linear-gradient(180deg,var(--card),var(--glass));padding:18px;border-radius:12px;color:var(--muted);box-shadow:0 6px 24px rgba(2,6,23,0.6)}
    .logo{display:flex;gap:12px;align-items:center;margin-bottom:18px}
    .logo h1{font-size:18px;margin:0;color:var(--accent)}
    .nav{display:flex;flex-direction:column;gap:6px}
    .nav button{background:transparent;border:0;padding:10px;border-radius:8px;text-align:left;color:var(--muted);cursor:pointer}
    .nav button.active, .nav button:hover{background:rgba(255,255,255,0.03);color:var(--accent)}

    /* Main */
    .main{display:flex;flex-direction:column;gap:18px}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .controls{display:flex;gap:8px;align-items:center}
    .card{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 6px 20px rgba(2,6,23,0.4)}
    .kpis{display:flex;gap:12px}
    .kpi{flex:1;padding:12px;border-radius:8px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent)}
    .kpi .title{font-size:12px;color:var(--muted);}
    .kpi .value{font-size:22px;color:white;margin-top:6px}
    .kpi .change{font-size:12px;margin-top:6px}

    .grid{display:grid;grid-template-columns:1fr 420px;gap:12px}
    .charts{display:flex;flex-direction:column;gap:12px}

    /* table */
    .table-wrap{overflow:auto}
    table{width:100%;border-collapse:collapse;color:var(--muted);min-width:700px}
    th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.03);text-align:left}
    th{font-size:12px;color:var(--muted);position:sticky;top:0;background:transparent}
    tr:hover td{background:rgba(255,255,255,0.02)}

    .small{font-size:12px}
    .muted{color:var(--muted)}
    .chip{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.02);font-size:12px}

    .toolbar{display:flex;gap:8px;align-items:center}
    .btn{padding:8px 12px;border-radius:8px;border:0;background:var(--accent);color:white;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}

    /* responsive */
    @media (max-width:900px){.app{grid-template-columns:1fr}.sidebar{display:none}.grid{grid-template-columns:1fr}.topbar{flex-direction:column;align-items:flex-start}}
  </style>
</head>
<body data-theme="dark">
  <div class="app">
    <aside class="sidebar card" aria-label="Sidebar navigation">
      <div class="logo"><svg width="36" height="36" viewBox="0 0 24 24" fill="none"><rect width="24" height="24" rx="6" fill="url(#g)"/></svg><div><h1>IIT Ops</h1><div class="small muted">Operations Dashboard</div></div></div>
      <nav class="nav" role="navigation">
        <button class="active">Overview</button>
        <button>Incidents</button>
        <button>Assets</button>
        <button>Reports</button>
        <button>Settings</button>
      </nav>

      <div style="margin-top:18px" class="small muted">Last sync: <span id="lastSync">—</span></div>
      <div style="margin-top:12px;display:flex;gap:8px">
        <button class="btn ghost" id="exportCsv">Export CSV</button>
        <button class="btn ghost" id="refreshNow">Refresh</button>
      </div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div>
          <h2 style="margin:0;color:white">Operations Overview</h2>
          <div class="small muted">Realtime telemetry, incidents and assets</div>
        </div>

        <div class="controls">
          <div class="toolbar card" style="display:flex;align-items:center;padding:8px">
            <label class="small muted" for="search">Search</label>
            <input id="search" placeholder="search incidents, assets..." style="margin-left:8px;padding:8px;border-radius:8px;border:0;background:transparent;color:white;outline:1px solid rgba(255,255,255,0.03)">
          </div>

          <div class="card" style="display:flex;align-items:center;gap:10px;padding:8px">
            <label class="small muted">Auto-refresh</label>
            <input type="checkbox" id="autoRefresh" checked>
            <label class="small muted">Theme</label>
            <button class="btn ghost" id="themeToggle">Toggle</button>
          </div>
        </div>
      </div>

      <section class="kpis">
        <div class="kpi card">
          <div class="title">Active Incidents</div>
          <div class="value" id="kpi-incidents">0</div>
          <div class="change" id="kpi-incidents-change">—</div>
        </div>
        <div class="kpi card">
          <div class="title">Systems Up</div>
          <div class="value" id="kpi-systems">0%</div>
          <div class="change" id="kpi-systems-change">—</div>
        </div>
        <div class="kpi card">
          <div class="title">Avg Response Time</div>
          <div class="value" id="kpi-rt">0s</div>
          <div class="change" id="kpi-rt-change">—</div>
        </div>
        <div class="kpi card">
          <div class="title">Open Tickets</div>
          <div class="value" id="kpi-tickets">0</div>
          <div class="change" id="kpi-tickets-change">—</div>
        </div>
      </section>

      <div class="grid">
        <div>
          <div class="charts">
            <div class="card">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><strong style="color:white">Incidents Over Time</strong><div class="small muted">last 24h</div></div>
              <canvas id="incidentsChart" height="120"></canvas>
            </div>

            <div class="card" style="display:flex;gap:12px">
              <div style="flex:1">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><strong style="color:white">Systems Health</strong><div class="small muted">by category</div></div>
                <canvas id="healthChart" height="160"></canvas>
              </div>
              <div style="width:260px">
                <div style="display:flex;flex-direction:column;gap:8px">
                  <div class="small muted">Top incidents</div>
                  <div id="topIncidents"></div>
                </div>
              </div>
            </div>

            <div class="card table-wrap">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><strong style="color:white">Incidents</strong>
                <div class="small muted">Showing <span id="tableCount"></span></div>
              </div>
              <table id="incTable">
                <thead>
                  <tr>
                    <th data-col="id">ID</th>
                    <th data-col="title">Title</th>
                    <th data-col="service">Service</th>
                    <th data-col="severity">Severity</th>
                    <th data-col="status">Status</th>
                    <th data-col="started">Started</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>

        <aside>
          <div class="card">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><strong style="color:white">Filters</strong>
              <div class="small muted">Quick filters</div>
            </div>
            <div style="display:flex;flex-direction:column;gap:8px">
              <select id="filterService"><option value="all">All services</option></select>
              <select id="filterSeverity"><option value="all">All severities</option><option value="critical">Critical</option><option value="major">Major</option><option value="minor">Minor</option></select>
              <select id="filterStatus"><option value="all">All statuses</option><option value="open">Open</option><option value="investigating">Investigating</option><option value="resolved">Resolved</option></select>
              <button class="btn" id="applyFilters">Apply</button>
            </div>
          </div>

          <div class="card" style="margin-top:12px">
            <strong style="color:white">Real-time Log</strong>
            <div id="realtimeLog" style="margin-top:8px;max-height:240px;overflow:auto;font-size:13px;color:var(--muted)"></div>
          </div>

          <div class="card" style="margin-top:12px">
            <strong style="color:white">Quick Actions</strong>
            <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
              <button class="btn" id="createIncident">Create Incident</button>
              <button class="btn ghost" id="resolveAll">Resolve All (demo)</button>
            </div>
          </div>
        </aside>
      </div>

    </main>
  </div>

  <script>
    // Demo single-file dashboard with simulated realtime updates
    (()=>{
      // Mock dataset
      const services = ['Auth','Network','Storage','Compute','DB','API Gateway'];
      const severities = ['critical','major','minor'];
      const statuses = ['open','investigating','resolved'];

      function randInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}
      function nowISO(){return new Date().toISOString()}

      // initial incidents
      let incidents = Array.from({length:12}).map((_,i)=>{
        const sev = severities[randInt(0,severities.length-1)];
        const serv = services[randInt(0,services.length-1)];
        const st = statuses[randInt(0,statuses.length-1)];
        return {id:1000+i,title:`${serv} ${sev} alert #${i+1}`,service:serv,severity:sev,status:st,started:new Date(Date.now()-randInt(5,3600)*1000).toISOString(),responseTime:randInt(30,600)}
      });

      // helper renderers
      const incCtx = document.getElementById('incidentsChart').getContext('2d');
      const healthCtx = document.getElementById('healthChart').getContext('2d');
      let incidentsChart, healthChart;

      function aggregate24h(){
        // bucket into 24 hourly points
        const points = Array(24).fill(0);
        const now = Date.now();
        incidents.forEach(it=>{
          const ageH = Math.floor((now - new Date(it.started))/3600000);
          if(ageH<24) points[23-ageH]++;
        });
        return points;
      }

      function getHealthCounts(){
        const counts = {};
        services.forEach(s=>counts[s]=0);
        // mock health: services with more than 2 open incidents are degraded
        incidents.forEach(i=>{ if(i.status!=='resolved') counts[i.service]++ });
        return services.map(s=>counts[s]);
      }

      function updateKPIs(){
        const active = incidents.filter(i=>i.status!=='resolved').length;
        const upPercent = Math.max(60, 100 - Math.round((active/services.length)*20));
        const avgRt = Math.round(incidents.reduce((s,i)=>s+i.responseTime,0)/Math.max(1,incidents.length));
        const openTickets = incidents.filter(i=>i.status!=='open').length;
        document.getElementById('kpi-incidents').innerText = active;
        document.getElementById('kpi-systems').innerText = upPercent + '%';
        document.getElementById('kpi-rt').innerText = avgRt + 's';
        document.getElementById('kpi-tickets').innerText = openTickets;

        document.getElementById('kpi-incidents-change').innerText = (Math.random()>0.5?'+':'-')+randInt(0,5)+' vs 1h';
        document.getElementById('lastSync').innerText = new Date().toLocaleString();
      }

      function renderCharts(){
        const labels = Array.from({length:24}).map((_,i)=>{
          const d = new Date(Date.now() - (23-i)*3600000);
          return d.getHours()+':00';
        });
        const data = aggregate24h();
        if(incidentsChart) incidentsChart.data.datasets[0].data = data, incidentsChart.update();
        else incidentsChart = new Chart(incCtx,{type:'bar',data:{labels, datasets:[{label:'Incidents',data,backgroundColor:'rgba(79,70,229,0.85)'}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}}}});

        const healthLabels = services;
        const healthData = getHealthCounts();
        if(healthChart) healthChart.data.datasets[0].data = healthData, healthChart.update();
        else healthChart = new Chart(healthCtx,{type:'bar',data:{labels:healthLabels,datasets:[{label:'Open incidents',data:healthData,backgroundColor:'rgba(79,70,229,0.85)'}]},options:{indexAxis:'y',responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}}}});
      }

      function populateTopIncidents(){
        const el = document.getElementById('topIncidents');
        const top = incidents.filter(i=>i.status!=='resolved').slice(0,4);
        el.innerHTML = top.map(t=>`<div style="padding:6px;border-radius:8px;background:rgba(255,255,255,0.01);margin-bottom:6px"><strong style="color:white">${t.title}</strong><div class=\"small muted\">${t.service} • ${t.severity} • ${new Date(t.started).toLocaleTimeString()}</div></div>`).join('') || '<div class="muted small">No active incidents</div>';
      }

      function populateTable(rows=incidents){
        const tbody = document.querySelector('#incTable tbody');
        tbody.innerHTML = rows.map(r=>`<tr><td>#${r.id}</td><td style=\"color:white\">${r.title}</td><td>${r.service}</td><td class=\"chip\">${r.severity}</td><td>${r.status}</td><td class=\"small muted\">${new Date(r.started).toLocaleString()}</td></tr>`).join('');
        document.getElementById('tableCount').innerText = rows.length;
      }

      function populateFilters(){
        const sel = document.getElementById('filterService');
        sel.innerHTML = '<option value="all">All services</option>' + services.map(s=>`<option value=\"${s}\">${s}</option>`).join('');
      }

      // search & filter
      function applyFilters(){
        const q = document.getElementById('search').value.toLowerCase();
        const serv = document.getElementById('filterService').value;
        const sev = document.getElementById('filterSeverity').value;
        const stat = document.getElementById('filterStatus').value;
        const filtered = incidents.filter(i=>{
          if(serv!=='all' && i.service!==serv) return false;
          if(sev!=='all' && i.severity!==sev) return false;
          if(stat!=='all' && i.status!==stat) return false;
          if(q && !(i.title.toLowerCase().includes(q) || String(i.id).includes(q) || i.service.toLowerCase().includes(q))) return false;
          return true;
        });
        populateTable(filtered);
      }

      // realtime simulation: occasionally create/resolve incidents
      function simulateTick(){
        // 30% chance to add
        if(Math.random()<0.3){
          const id = 2000 + randInt(1,999);
          const serv = services[randInt(0,services.length-1)];
          const sev = severities[randInt(0,severities.length-1)];
          const inc = {id,title:`${serv} ${sev} alert ${id}`,service:serv,severity:sev,status:'open',started:new Date().toISOString(),responseTime:randInt(20,900)};
          incidents.unshift(inc);
          log(`Created incident ${inc.id} (${inc.service} / ${inc.severity})`);
        }
        // 20% chance to resolve one
        if(Math.random()<0.2 && incidents.length){
          const idx = randInt(0,incidents.length-1);
          incidents[idx].status = 'resolved';
          log(`Resolved incident ${incidents[idx].id}`);
        }
        // small variance in response times
        incidents.forEach(i=>{ i.responseTime = Math.max(10, i.responseTime + randInt(-5,5)); });

        // keep list manageable
        incidents = incidents.slice(0,200);

        updateKPIs(); renderCharts(); populateTopIncidents(); applyFilters();
      }

      function log(msg){
        const el = document.getElementById('realtimeLog');
        const now = new Date().toLocaleTimeString();
        el.insertAdjacentHTML('afterbegin',`<div style=\"padding:6px 0;border-bottom:1px solid rgba(255,255,255,0.02)\"><span class=\"small muted\">${now}</span> — <span style=\"color:white\">${msg}</span></div>`);
        // cap lines
        while(el.children.length>200) el.removeChild(el.lastChild);
      }

      // export CSV
      function exportCSV(){
        const rows = incidents.map(r=>[r.id, r.title, r.service, r.severity, r.status, r.started, r.responseTime]);
        const csv = ['ID,Title,Service,Severity,Status,Started,ResponseTime', ...rows.map(r=>r.map(c=>`"${String(c).replace(/"/g,'""')}"`).join(','))].join('\n');
        const blob = new Blob([csv],{type:'text/csv'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href=url; a.download='iit-incidents.csv'; a.click(); URL.revokeObjectURL(url);
      }

      // create incident (manual)
      function createIncident(){
        const id = 9000 + randInt(1,999);
        const serv = services[randInt(0,services.length-1)];
        const sev = severities[randInt(0,severities.length-1)];
        const inc = {id,title:`${serv} ${sev} alert ${id}`,service:serv,severity:sev,status:'open',started:new Date().toISOString(),responseTime:randInt(10,500)};
        incidents.unshift(inc);
        log(`Manually created incident ${inc.id}`);
        simulateTick();
      }

      // resolve all demo
      function resolveAll(){ incCountBefore=incidents.length; incidents.forEach(i=>i.status='resolved'); log('All incidents set to resolved (demo)'); simulateTick(); }

      // wire UI
      document.getElementById('exportCsv').addEventListener('click',exportCSV);
      document.getElementById('refreshNow').addEventListener('click',()=>{simulateTick(); log('Manual refresh');});
      document.getElementById('applyFilters').addEventListener('click',applyFilters);
      document.getElementById('search').addEventListener('input',applyFilters);
      document.getElementById('createIncident').addEventListener('click',createIncident);
      document.getElementById('resolveAll').addEventListener('click',resolveAll);

      document.getElementById('themeToggle').addEventListener('click',()=>{
        const el = document.body; el.dataset.theme = el.dataset.theme==='dark'?'light':'dark';
      });

      document.getElementById('autoRefresh').addEventListener('change',function(){ if(this.checked) startAuto(); else stopAuto(); });

      // simple table sort on header clicks
      Array.from(document.querySelectorAll('#incTable th')).forEach(th=>{
        th.style.cursor='pointer'; th.addEventListener('click',()=>{
          const col = th.dataset.col; incidents.sort((a,b)=> String(a[col]||'').localeCompare(String(b[col]||''))); populateTable();
        })
      });

      // initial render
      populateFilters(); updateKPIs(); renderCharts(); populateTopIncidents(); populateTable();

      // auto refresh
      let autoHandle=null;
      function startAuto(){ if(autoHandle) return; autoHandle=setInterval(simulateTick,5000); }
      function stopAuto(){ clearInterval(autoHandle); autoHandle=null; }
      startAuto();

      // expose for debugging in console
      window.__IIT = {incidents, simulateTick, exportCSV};

    })();
  </script>
</body>
</html>
